(function(){"use strict";function a(t,e,n,_,y,g,p,v){var i=typeof t=="function"?t.options:t;return e&&(i.render=e,i.staticRenderFns=n,i._compiled=!0),{exports:t,options:i}}const s={props:{help:String,label:String,when:String,theme:{type:String,default:"info"},loading:{type:Boolean,default:!1},interval:{type:Number,default:0}},data(){return{auser:void 0,datetime:void 0,hasUserChange:!1}},created(){this.syncContent(),this.interval>0&&setInterval(this.syncContent,this.interval*1e3)},watch:{hasChanges(){this.hasChanges||this.syncContent()}},computed:{hasChanges(){return Object.keys(this.$panel.content.diff()).length>0},dynText(){return this.auser+", "+this.datetime},dynTheme(){return this.hasUserChange?"negative":this.hasChanges||this.loading?"notice":this.theme}},methods:{syncContent(){let t=this.$panel.view.props.model.id;this.$api.get("recentlymodified/field",{id:t.split("?")[0]}).then(e=>{this.auser!==void 0&&this.auser!==e.auser&&(this.hasUserChange=!0),this.auser=e.auser,this.datetime=e.datetime,this.loading=!1}).catch(e=>{this.loading=!1})}}};var l=function(){var e=this,n=e._self._c;return n("k-field",{staticClass:"k-recentlymodified-field",attrs:{help:e.help,label:e.label,when:e.when}},[n("k-box",{staticClass:"recentlymodified-text",attrs:{theme:e.dynTheme,name:"textfield",text:e.dynText}})],1)},d=[],r=a(s,l,d);const h=r.exports,o={data(){return{label:void 0,headline:void 0,layout:"list",links:[]}},created(){this.load().then(t=>{var e,n;this.label=((e=t.label)==null?void 0:e.length)>0?t.label:void 0,this.headline=((n=t.headline)==null?void 0:n.length)>0?t.headline:void 0,this.links=t.query})},computed:{labelOrHeadline(){return this.label??this.headline??"Recently Modified"}}};var c=function(){var e=this,n=e._self._c;return n("section",{staticClass:"k-section k-links-section"},[n("header",{staticClass:"k-section-header"},[n("h2",{staticClass:"k-label k-section-label"},[n("span",{staticClass:"k-label-text"},[e._v(e._s(this.labelOrHeadline))])])]),n("k-collection",{attrs:{items:e.links,layout:e.layout}})],1)},f=[],u=a(o,c,f);const m=u.exports;panel.plugin("bnomei/recently-modified",{fields:{recentlymodified:h},sections:{recentlymodified:m}})})();
